

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>RTBGym &#8212; SCOPE-RL</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">SCOPE-RL</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quickstart.html">
                        Quickstart
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../index.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../examples/index.html">
                        Usage
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="index.html">
                        Sub-packages
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../frequently_asked_questions.html">
                        FAQs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../news.html">
                        News
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-external" href="https://github.com/hakuhodo-technologies/scope-rl/releases">
                        Release Notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-external" href="https://github.com/hakuhodo-technologies/scope-rl/404">
                        Proceedings
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hakuhodo-technologies/scope-rl" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://speakerdeck.com/aiueola/ofrl-designing-an-offline-reinforcement-learning-and-policy-evaluation-platform-from-practical-perspectives" title="Speaker Deck" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-speaker-deck"></i></span>
            <label class="sr-only">Speaker Deck</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quickstart.html">
                        Quickstart
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../index.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../examples/index.html">
                        Usage
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="index.html">
                        Sub-packages
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../frequently_asked_questions.html">
                        FAQs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../news.html">
                        News
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-external" href="https://github.com/hakuhodo-technologies/scope-rl/releases">
                        Release Notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-external" href="https://github.com/hakuhodo-technologies/scope-rl/404">
                        Proceedings
                      </a>
                    </li>
                
                </div>
            </div>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hakuhodo-technologies/scope-rl" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://speakerdeck.com/aiueola/ofrl-designing-an-offline-reinforcement-learning-and-policy-evaluation-platform-from-practical-perspectives" title="Speaker Deck" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-speaker-deck"></i></span>
            <label class="sr-only">Speaker Deck</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">RTBGym</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="rtbgym">
<h1>RTBGym<a class="headerlink" href="#rtbgym" title="Permalink to this heading">#</a></h1>
<h3> Python-based configurative simulation environment for Real-Time Bidding (RTB)</h3><section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p><em>RTBGym</em> is an open-source simulation platform for Real-Time Bidding (RTB) of Display Advertising.
The simulator is particularly intended for reinforcement learning algorithms and follows <a class="reference external" href="https://github.com/openai/gym">OpenAI Gym</a> and <a class="reference external" href="https://github.com/Farama-Foundation/Gymnasium">Gymnasium</a> interface.
We design RTBGym as a configurative environment so that researchers and practitioners can customize the environmental modules including WinningPriceDistribution, ClickThroughRate, and ConversionRate.</p>
<p>Note that RTBGym is publicized as a sub-package of <a class="reference internal" href="../index.html"><span class="doc">SCOPE-RL</span></a>, which streamlines the implementation of offline reinforcement learning (offline RL) and off-policy evaluation and selection (OPE/OPS) procedures.</p>
</section>
<section id="basic-setting">
<h2>Basic Setting<a class="headerlink" href="#basic-setting" title="Permalink to this heading">#</a></h2>
<p>In RTB, the objective of the RL agent is to maximize some Key Performance Indicators (KPIs, e.g., the number of clicks or conversions) within an episode under given budget constraints.
We often aim to achieve this goal by adjusting a parameter <span class="math notranslate nohighlight">\(\alpha\)</span> to control the bid price as follows.</p>
<div class="math notranslate nohighlight">
\[bid_{t,i} = \alpha \cdot r^{\ast}\]</div>
<p>where <span class="math notranslate nohighlight">\(r^{\ast}\)</span> denotes a predicted or expected reward (KPIs).</p>
<p>We often formulate this RTB problem as the following Constrained Markov Decision Process (CMDP) as <span class="math notranslate nohighlight">\(\langle \mathcal{S}, \mathcal{A}, \mathcal{T}, P_r, \gamma, C \rangle\)</span>.</p>
<ul>
<li><p><cite>timestep</cite> (<span class="math notranslate nohighlight">\(1 \leq t \leq T\)</span>): One episode (a day or a week) consists of several timesteps (24 hours or seven days, for instance).</p></li>
<li><p><cite>state</cite> (<span class="math notranslate nohighlight">\(s \in \mathcal{S}\)</span>): We observe some feedback from the environment at each timestep, which includes the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>timestep</p></li>
<li><p>remaining budget</p></li>
<li><p>impression level features (budget consumption rate, cost per mille of impressions, auction winning rate, reward) at the previous timestep</p></li>
<li><p>adjust rate (RL agent’s decision making) at the previous timestep</p></li>
</ul>
</div></blockquote>
</li>
<li><p><cite>action</cite> (<span class="math notranslate nohighlight">\(a \in \mathcal{A}\)</span>): Agent chooses adjust rate parameter <span class="math notranslate nohighlight">\(\alpha\)</span> to maximize KPIs.</p></li>
<li><p><cite>reward</cite> (<span class="math notranslate nohighlight">\(r \in \mathbb{R}\)</span>): Total number of clicks or conversions obtained during the timestep.</p></li>
<li><p><cite>constraints</cite> (<span class="math notranslate nohighlight">\(C\)</span>): The pre-determined episodic budget should not be exceeded.</p></li>
</ul>
<p>Note that <span class="math notranslate nohighlight">\(\mathcal{T}: \mathcal{S} \times \mathcal{A} \rightarrow \mathcal{P}(\mathcal{S})\)</span> is the state transition probability where <span class="math notranslate nohighlight">\(\mathcal{T}(s'\mid s,a)\)</span> is the probability of observing state <span class="math notranslate nohighlight">\(s'\)</span> after taking action <span class="math notranslate nohighlight">\(a\)</span> given state <span class="math notranslate nohighlight">\(s\)</span>.
<span class="math notranslate nohighlight">\(P_r: \mathcal{S} \times \mathcal{A} \times \mathbb{R} \rightarrow [0,1]\)</span> is the probability distribution of the immediate reward.
Given <span class="math notranslate nohighlight">\(P_r\)</span>, <span class="math notranslate nohighlight">\(R: \mathcal{S} \times \mathcal{A} \rightarrow \mathbb{R}\)</span> is the expected reward function where <span class="math notranslate nohighlight">\(R(s,a) := \mathbb{E}_{r \sim P_r (r \mid s, a)}[r]\)</span> is the expected reward when taking action <span class="math notranslate nohighlight">\(a\)</span> for state <span class="math notranslate nohighlight">\(s\)</span>.
We also let <span class="math notranslate nohighlight">\(\gamma \in (0,1]\)</span> be a discount factor and <span class="math notranslate nohighlight">\(C \ge 0\)</span> be a budget constraint.
Finally, <span class="math notranslate nohighlight">\(\pi: \mathcal{S} \rightarrow \mathcal{P}(\mathcal{A})\)</span> denotes a policy (i.e., agent) where <span class="math notranslate nohighlight">\(\pi(a | s)\)</span> is the probability of taking action <span class="math notranslate nohighlight">\(a\)</span> at a given state <span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>Based on this formulation, our goal is to maximize the expected trajectory-wise reward while satisfying the cost (i.e., budget) constraints as follows.</p>
<div class="math notranslate nohighlight">
\[\max_{\pi \in \Pi} \, \, \mathbb{E} \left [ \sum_{t=0}^{T} \gamma^t r_t \mid \pi \right ]\]</div>
<div class="math notranslate nohighlight">
\[\text{s.t.} \, \, \mathbb{E} \left [ \sum_{t=0}^{T} c_t \mid \pi \right ] \leq C\]</div>
</section>
<section id="supported-implementation">
<h2>Supported Implementation<a class="headerlink" href="#supported-implementation" title="Permalink to this heading">#</a></h2>
<section id="standard-environment">
<h3>Standard Environment<a class="headerlink" href="#standard-environment" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RTBEnv-discrete-v0</span></code>: Standard RTB environment with discrete action space.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RTBEnv-continuous-v0</span></code>: Standard RTB environment with continuous action space.</p></li>
</ul>
</div></blockquote>
</section>
<section id="custom-environment">
<h3>Custom Environment<a class="headerlink" href="#custom-environment" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RTBEnv</span></code>: The basic configurative environment with continuous action space.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CustomizedRTBEnv</span></code>: The customized environment given action space and reward predictor.</p></li>
</ul>
</div></blockquote>
</section>
<section id="configurative-modules">
<h3>Configurative Modules<a class="headerlink" href="#configurative-modules" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">WinningPriceDistribution</span></code>: Class to define the winning price distribution of the auction bidding.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ClickThroughRate</span></code>: Class to define the click through rate of users.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ConversionRate</span></code>: Class to define the conversion rate of users.</p></li>
</ul>
</div></blockquote>
<p>Note that users can customize the above modules by following the abstract class.
We also define the bidding function in the Bidder class and the auction simulation in the Simulator class, respectively.</p>
</section>
</section>
<section id="quickstart-and-configurations">
<h2>Quickstart and Configurations<a class="headerlink" href="#quickstart-and-configurations" title="Permalink to this heading">#</a></h2>
<p>We provide an example usage of the standard and customized environment.</p>
<section id="standard-rtbenv">
<h3>Standard RTBEnv<a class="headerlink" href="#standard-rtbenv" title="Permalink to this heading">#</a></h3>
<p>Our standard RTBEnv is available from <code class="xref py py-class docutils literal notranslate"><span class="pre">gym.make()</span></code>,
following the <a class="reference external" href="https://github.com/openai/gym">OpenAI Gym</a> and <a class="reference external" href="https://github.com/Farama-Foundation/Gymnasium">Gymnasium</a> interface.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import rtbgym and gym</span>
<span class="kn">import</span> <span class="nn">rtbgym</span>
<span class="kn">import</span> <span class="nn">gym</span>

<span class="c1"># (1) standard environment for discrete action space</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;RTBEnv-discrete-v0&#39;</span><span class="p">)</span>

<span class="c1"># (2) standard environment for continuous action space</span>
<span class="n">env_</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;RTBEnv-continuous-v0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The basic interaction is performed using only four lines of code as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obs</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">(),</span> <span class="kc">False</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
   <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
   <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">truncated</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s interact uniform random policy with a continuous action RTB environment. The discrete action case also works in a similar manner.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import from other libraries</span>
<span class="kn">from</span> <span class="nn">scope_rl.policy</span> <span class="kn">import</span> <span class="n">OnlineHead</span>
<span class="kn">from</span> <span class="nn">d3rlpy.algos</span> <span class="kn">import</span> <span class="n">RandomPolicy</span> <span class="k">as</span> <span class="n">ContinuousRandomPolicy</span>
<span class="kn">from</span> <span class="nn">d3rlpy.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxActionScaler</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># define a random agent (for continuous action)</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">OnlineHead</span><span class="p">(</span>
    <span class="n">ContinuousRandomPolicy</span><span class="p">(</span>
        <span class="n">action_scaler</span><span class="o">=</span><span class="n">MinMaxActionScaler</span><span class="p">(</span>
            <span class="n">minimum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># minimum value that policy can take</span>
            <span class="n">maximum</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># maximum value that policy can take</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># (3) basic interaction for continuous action case</span>
<span class="n">obs</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">predict_online</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">truncated</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that while we use <span class="xref std std-doc">SCOPE-RL</span> and <a class="reference external" href="https://github.com/takuseno/d3rlpy">d3rlpy</a> here,
RTBGym is compatible with any other libraries that is compatible to the <a class="reference external" href="https://github.com/openai/gym">OpenAI Gym</a>
and <a class="reference external" href="https://github.com/Farama-Foundation/Gymnasium">Gymnasium</a> interface.</p>
</section>
<section id="customized-rtbenv">
<h3>Customized RTBEnv<a class="headerlink" href="#customized-rtbenv" title="Permalink to this heading">#</a></h3>
<p>Next, we describe how to customize the environment by instantiating the environment.</p>
<p>The list of arguments are given as follows.</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">objective</span></code>: Objective KPIs of RTB, which is either “click” or “conversion”.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">cost_indicator</span></code>: Timing of arising costs, which is any of “impression”, “click”, and “conversion”.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">step_per_episode</span></code>: Number of timesteps in an episode.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">initial_budget</span></code>: Initial budget (i.e., constraint) for an episode.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n_ads</span></code>: Number of ads used for auction bidding.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n_users</span></code>: Number of users used for auction bidding.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ad_feature_dim</span></code>: Dimensions of the ad feature vectors.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">user_feature_dim</span></code>: Dimensions of the user feature vectors.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ad_feature_vector</span></code>: Feature vectors that characterizes each ad.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">user_feature_vector</span></code>: Feature vectors that characterizes each user.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ad_sampling_rate</span></code>: Sampling probabilities to determine which ad (id) is used in each auction.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">user_sampling_rate</span></code>: Sampling probabilities to determine which user (id) is used in each auction.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">WinningPriceDistribution</span></code>: Winning price distribution of auctions.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ClickTroughRate</span></code>: Click through rate (i.e., click / impression).</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ConversionRate</span></code>: Conversion rate (i.e., conversion / click).</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">standard_bid_price_distribution</span></code>: Distribution of the bid price whose average impression probability is expected to be 0.5.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">minimum_standard_bid_price</span></code>: Minimum value for standard bid price.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">search_volume_distribution</span></code>: Search volume distribution for each timestep.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">minimum_search_volume</span></code>: Minimum search volume at each timestep.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">random_state</span></code>: Random state.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rtbgym</span> <span class="kn">import</span> <span class="n">RTBEnv</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">RTBEnv</span><span class="p">(</span>
    <span class="n">objective</span><span class="o">=</span><span class="s2">&quot;click&quot;</span><span class="p">,</span>  <span class="c1"># maximize the number of total impressions</span>
    <span class="n">cost_indicator</span><span class="o">=</span><span class="s2">&quot;click&quot;</span><span class="p">,</span>  <span class="c1"># cost arises every time click occurs</span>
    <span class="n">step_per_episode</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>  <span class="c1"># 14 days as an episode</span>
    <span class="n">initial_budget</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>  <span class="c1"># budget available for 14 dayas is 5000</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In particular, users can define their own <code class="xref py py-class docutils literal notranslate"><span class="pre">WinningPriceDistribution</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ClickThroughRate</span></code>, and <code class="xref py py-class docutils literal notranslate"><span class="pre">ConversionRate</span></code> as follows.</p>
<p>Example of Custom Winning Price Distribution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import RTBGym modules</span>
<span class="kn">from</span> <span class="nn">rtbgym</span> <span class="kn">import</span> <span class="n">BaseWinningPriceDistribution</span>
<span class="kn">from</span> <span class="nn">rtbgym.utils</span> <span class="kn">import</span> <span class="n">NormalDistribution</span>
<span class="c1"># import other necessary stuffs</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">CustomizedWinningPriceDistribution</span><span class="p">(</span><span class="n">BaseWinningPriceDistribution</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialization.&quot;&quot;&quot;</span>
    <span class="n">n_ads</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">n_users</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">ad_feature_dim</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">user_feature_dim</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">step_per_episode</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">standard_bid_price_distribution</span><span class="p">:</span> <span class="n">NormalDistribution</span> <span class="o">=</span> <span class="n">NormalDistribution</span><span class="p">(</span>
        <span class="n">mean</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="n">std</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">minimum_standard_bid_price</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sample_outcome</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bid_prices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stochastically determine impression and second price for each auction.&quot;&quot;&quot;</span>
        <span class="c1"># sample winning price from simple normal distribution</span>
        <span class="n">winning_prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
            <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_bid_price</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_bid_price</span> <span class="o">/</span> <span class="mi">5</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">bid_prices</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">impressions</span> <span class="o">=</span> <span class="n">winning_prices</span> <span class="o">&lt;</span> <span class="n">bid_prices</span>
        <span class="k">return</span> <span class="n">impressions</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">winning_prices</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">standard_bid_price</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_bid_price_distribution</span><span class="o">.</span><span class="n">mean</span>
</pre></div>
</div>
<p>Example of Custom ClickThroughRate (and Conversion Rate):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rtbgym</span> <span class="kn">import</span> <span class="n">BaseClickAndConversionRate</span>
<span class="kn">from</span> <span class="nn">rtbgym.utils</span> <span class="kn">import</span> <span class="n">sigmoid</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">CustomizedClickThroughRate</span><span class="p">(</span><span class="n">BaseClickAndConversionRate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialization.&quot;&quot;&quot;</span>
    <span class="n">n_ads</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">n_users</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">ad_feature_dim</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">user_feature_dim</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">step_per_episode</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ad_coef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
            <span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ad_feature_dim</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_coef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
            <span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_feature_dim</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">calc_prob</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ad_ids</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">user_ids</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">ad_feature_vector</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">user_feature_vector</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">timestep</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate CTR (i.e., click per impression).&quot;&quot;&quot;</span>
        <span class="n">ad_latent</span> <span class="o">=</span> <span class="n">ad_feature_vector</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">ad_coef</span>
        <span class="n">user_latent</span> <span class="o">=</span> <span class="n">user_feature_vector</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_coef</span>
        <span class="n">ctrs</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">((</span><span class="n">ad_latent</span> <span class="o">*</span> <span class="n">user_latent</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ctrs</span>

    <span class="k">def</span> <span class="nf">sample_outcome</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ad_ids</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">user_ids</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">ad_feature_vector</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">user_feature_vector</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">timestep</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stochastically determine whether click occurs in impression=True case.&quot;&quot;&quot;</span>
        <span class="n">ctrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_prob</span><span class="p">(</span>
            <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
            <span class="n">ad_ids</span><span class="o">=</span><span class="n">ad_ids</span><span class="p">,</span>
            <span class="n">user_ids</span><span class="o">=</span><span class="n">user_ids</span><span class="p">,</span>
            <span class="n">ad_feature_vector</span><span class="o">=</span><span class="n">ad_feature_vector</span><span class="p">,</span>
            <span class="n">user_feature_vector</span><span class="o">=</span><span class="n">user_feature_vector</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">clicks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ad_ids</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">ctrs</span>
        <span class="k">return</span> <span class="n">clicks</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that custom conversion rate can be defined in a similar manner.</p>
</section>
<section id="wrapper-class-for-custom-bidding-setup">
<h3>Wrapper class for custom bidding setup<a class="headerlink" href="#wrapper-class-for-custom-bidding-setup" title="Permalink to this heading">#</a></h3>
<p>To customize the bidding setup, we also provide <code class="xref py py-class docutils literal notranslate"><span class="pre">CustomizedRTBEnv</span></code>, which enables discretization or re-definition of the action space.
In addition, users can set their own <code class="xref py py-class docutils literal notranslate"><span class="pre">reward_predictor</span></code>.</p>
<p>The list of arguments are given as follows.</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">original_env</span></code>: Original RTB Environment.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">reward_predictor</span></code>: A machine learning model to predict the reward to determine the bidding price.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">scaler</span></code>: Scaling factor (constant value) used for bid price determination. (None for the auto-fitting)</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">action_min</span></code>: Minimum value of adjust rate.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">action_max</span></code>: Maximum value of adjust rate.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">action_type</span></code>: Action type of the RL agent, which is either “discrete” or “continuous”.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n_actions</span></code>: Number of “discrete” actions.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">action_meaning</span></code>: Mapping function of agent action index to the actual “discrete” action to take.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rtbgym</span> <span class="kn">import</span> <span class="n">CustomizedRTBEnv</span>
<span class="n">custom_env</span> <span class="o">=</span> <span class="n">CustomizedRTBEnv</span><span class="p">(</span>
    <span class="n">original_env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
    <span class="n">reward_predictor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># use ground-truth (expected) reward as a reward predictor (oracle)</span>
    <span class="n">action_type</span><span class="o">=</span><span class="s2">&quot;discrete&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>More examples are available at <a class="reference external" href="https://github.com/hakuhodo-technologies/scope-rl/tree/main/examples/quickstart/rtb">Quickstarts for RTBGym</a>.</p>
</section>
</section>
<section id="citation">
<h2>Citation<a class="headerlink" href="#citation" title="Permalink to this heading">#</a></h2>
<p>If you use our pipeline in your work, please cite our paper below.</p>
<div class="line-block">
<div class="line">Haruka Kiyohara, Kosuke Kawakami, Yuta Saito.</div>
<div class="line"><strong>Accelerating Offline Reinforcement Learning Application in Real-Time Bidding and Recommendation: Potential Use of Simulation</strong> [<a class="reference external" href="https://arxiv.org/abs/2109.08331">arXiv</a>]</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@article</span><span class="p">{</span><span class="n">kiyohara2021accelerating</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="n">Accelerating</span> <span class="n">Offline</span> <span class="n">Reinforcement</span> <span class="n">Learning</span> <span class="n">Application</span> <span class="ow">in</span> <span class="n">Real</span><span class="o">-</span><span class="n">Time</span> <span class="n">Bidding</span> <span class="ow">and</span> <span class="n">Recommendation</span><span class="p">:</span> <span class="n">Potential</span> <span class="n">Use</span> <span class="n">of</span> <span class="n">Simulation</span><span class="p">},</span>
    <span class="n">author</span><span class="o">=</span><span class="p">{</span><span class="n">Kiyohara</span><span class="p">,</span> <span class="n">Haruka</span> <span class="ow">and</span> <span class="n">Kawakami</span><span class="p">,</span> <span class="n">Kosuke</span> <span class="ow">and</span> <span class="n">Saito</span><span class="p">,</span> <span class="n">Yuta</span><span class="p">},</span>
    <span class="n">journal</span><span class="o">=</span><span class="p">{</span><span class="n">arXiv</span> <span class="n">preprint</span> <span class="n">arXiv</span><span class="p">:</span><span class="mf">2109.08331</span><span class="p">},</span>
    <span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2021</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="contact">
<h2>Contact<a class="headerlink" href="#contact" title="Permalink to this heading">#</a></h2>
<p>For any question about the paper and pipeline, feel free to contact: <a class="reference external" href="mailto:hk844&#37;&#52;&#48;cornell&#46;edu">hk844<span>&#64;</span>cornell<span>&#46;</span>edu</a></p>
</section>
<section id="contribution">
<h2>Contribution<a class="headerlink" href="#contribution" title="Permalink to this heading">#</a></h2>
<p>Any contributions to RTBGym are more than welcome!
Please refer to <a class="reference external" href="https://github.com/hakuhodo-technologies/scope-rl/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a> for general guidelines how to contribute to the project.</p>
<div class="sd-container-fluid sd-sphinx-override sd-m-0 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column sd-col-3 sd-col-xs-3 sd-col-sm-3 sd-col-md-3 sd-col-lg-3 sd-m-0 sd-p-0 docutils">
<div class="sd-container-fluid sd-sphinx-override sd-m-0 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-row sd-m-0 sd-p-0 docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-none sd-card-hover docutils">
<div class="sd-card-body docutils">
<p class="sd-card-text">&lt;&lt;&lt; Prev
<strong>Sub_packages (Back to Top)</strong></p>
</div>
<a class="sd-stretched-link reference internal" href="index.html"><span class="doc"></span></a></div>
</div>
<div class="sd-col sd-d-flex-row sd-m-0 sd-p-0 docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-none sd-card-hover docutils">
<div class="sd-card-body docutils">
<p class="sd-card-text">&lt;&lt;&lt; Prev
<strong>Documentation (Back to Top)</strong></p>
</div>
<a class="sd-stretched-link reference internal" href="index.html"><span class="doc"></span></a></div>
</div>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 sd-m-0 sd-p-0 docutils">
</div>
<div class="sd-col sd-d-flex-column sd-col-3 sd-col-xs-3 sd-col-sm-3 sd-col-md-3 sd-col-lg-3 sd-m-0 sd-p-0 docutils">
<div class="sd-container-fluid sd-sphinx-override sd-m-0 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-row sd-m-0 sd-p-0 docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-none sd-card-hover docutils">
<div class="sd-card-body docutils">
<p class="sd-card-text">Next &gt;&gt;&gt;
<strong>Package Reference</strong></p>
</div>
<a class="sd-stretched-link reference internal" href="rtbgym_api.html"><span class="doc"></span></a></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-setting">Basic Setting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supported-implementation">Supported Implementation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-environment">Standard Environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-environment">Custom Environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configurative-modules">Configurative Modules</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quickstart-and-configurations">Quickstart and Configurations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-rtbenv">Standard RTBEnv</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customized-rtbenv">Customized RTBEnv</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wrapper-class-for-custom-bidding-setup">Wrapper class for custom bidding setup</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citation">Citation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contact">Contact</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contribution">Contribution</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner"></div>
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, Haruka Kiyohara, Ren Kishimoto, HAKUHODO Technologies Inc., Hanjuku-kaso Co., Ltd.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>